#Report of Lab3  
#【练习0】填写已有实验  
本实验依赖实验1/2。请把你做的实验1/2的代码填入本实验中代码中有“LAB1”,“LAB2”的注释相应部分。   

> 详情见代码。   

#【练习1】给未被映射的地址映射上物理页   
完成do_pgfault(mm/vmm.c)函数,给未被映射的地址映射上物理页。设置访问权限的时候需要参考页面所在VMA的权限,同时需要注意映射物理页时需要操作内存控制	结构所指定的页表,而不是内核的页表。注意:在LAB2 EXERCISE 1处填写代码。  

> 详情见代码，主要根据注释完成相应的code。 

#【练习1问题1】  
请描述页目录项(Pag Director Entry)和页表(Page Table Entry)中组成部分对ucore实现页替换算法的潜在用处。   

> 页表和页目录表项可以记录一个页的访问或者分配信息，在实现不同的置换算法的时候我们需要不同的参数，比如页进入页表的时间，也被访问和修改的时间等等，这些都是我们实现不同算法时所必须的参数，而index的作用我们可以通过改变index来改变相应的指针等等。  

#【练习1问题2】  
如果ucore的缺页服务例程在执行过程中访问内存,出现了页访问异常,请问硬件要做哪些事情?   

> 出现异常，首先硬件要保存现场，也就是保存相应寄存器的值，维护相应的堆栈，然后交给异常处理程序处理即可。  

#【练习2】补充完成基于FIFO的页面替换算法   
完成vmm.c中的do_pgfault函数,并且在实现FIFO算法的swap_fifo.c中完成map_swappable和swap_out_vistim函数。通过对swap的测试。注意:在LAB2 EXERCISE 2处填写代码。 

> 详情见代码，主要根据所给注释完成相应的code。   

#【练习2问题1】   
如果要在ucore上实现"extended clock页替换算法"请给你的设计方案,现有的swap_manager框架是否足以支持在ucore中实现此算法?如果是,请给你的设计方案。如果不是,请给出你的新的扩展和基此扩展的设计方案。并需要回答如下问题    
需要被换出的页的特征是什么?   
在ucore中如何判断具有这样特征的页?    
何时进行换入和换出操作?  

> 现有的swap_manager并不能支持实现时钟算法，要实现时钟算法，我们可以利用数组记录相应swap页的标志位信息，当然它会根据相应swap的页变换而变换，然后就是时钟问题，我们可以将时间分片处理，对一周期时间进行分片，在一片时间内当需要swap时访问页面的标志位，然后进行替换。   
需要被替换的页的特征就是修改位和使用位是0；   
遍历上述思路中的数组，找到相应的标志位满足置换条件的页；   
根据需要，当所访问的页存在与磁盘中但不在内存中，而此时内存中页已经满了，这时需要替换，根据不同的替换算法找到需要替换的页在内存中删除，然后将需要添加的页添加到内存中即可。 

